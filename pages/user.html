<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Account - Petal</title>
    <link rel="stylesheet" href="../styles/output.css" />
    <style>
      body {
        background-color: #000;
        color: #f4f4f5;
      }

      .glass {
        background: rgba(24, 24, 27, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .btn-primary {
        background: #22c55e;
        color: #000;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: bold;
        transition: background 0.3s;
        border: none;
        cursor: pointer;
      }

      .btn-primary:hover {
        background: #16a34a;
      }

      .btn-secondary {
        background: transparent;
        color: #f4f4f5;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        font-weight: bold;
        transition: all 0.3s;
        cursor: pointer;
      }

      .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.1);
      }
    </style>
  </head>
  <body>
    <nav
      class="sticky top-0 z-100 border-b border-white/5 bg-black/80 backdrop-blur-xl px-6 py-4"
    >
      <div class="max-w-7xl mx-auto flex items-center justify-between">
        <a href="../index.html" class="flex items-center gap-2 cursor-pointer">
          <i data-lucide="sprout" class="text-green-500"></i>
          <span class="text-2xl font-black tracking-tighter uppercase"
            >Petal</span
          >
        </a>
        <div class="flex items-center gap-4">
          <span id="user-name" class="text-sm"></span>
          <button id="logout-btn" class="btn-secondary">Logout</button>
        </div>
      </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-12">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Profile Info -->
        <div class="glass p-6 rounded-3xl">
          <h2 class="text-2xl font-bold mb-4">Profile</h2>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-1">Name</label>
              <p id="profile-name" class="text-zinc-300"></p>
            </div>
            <div>
              <label class="block text-sm font-medium mb-1">Email</label>
              <p id="profile-email" class="text-zinc-300"></p>
            </div>
            <div>
              <label class="block text-sm font-medium mb-1">Member Since</label>
              <p id="profile-since" class="text-zinc-300"></p>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="glass p-6 rounded-3xl">
          <h2 class="text-2xl font-bold mb-4">Quick Actions</h2>
          <div class="space-y-3">
            <a href="orders.html" class="btn-primary w-full block text-center"
              >View Orders</a
            >
            <a
              href="../index.html"
              class="btn-secondary w-full block text-center"
              >Continue Shopping</a
            >
            <a
              href="checkout.html"
              class="btn-secondary w-full block text-center"
              >Checkout Cart</a
            >
          </div>
        </div>

        <!-- Recent Orders -->
        <div class="glass p-6 rounded-3xl">
          <h2 class="text-2xl font-bold mb-4">Recent Orders</h2>
          <div id="recent-orders" class="space-y-3">
            <!-- Orders will be populated by JavaScript -->
          </div>
          <a
            href="orders.html"
            class="text-green-500 hover:underline text-sm mt-4 block"
            >View all orders</a
          >
        </div>
      </div>
    </main>

    <script src="../node_modules/lucide/dist/umd/lucide.js"></script>
    <script src="../scripts/app.js"></script>
    <script>
      let currentUser = petalApp.getCurrentUser();
      let users = petalApp.getUsers();

      if (!currentUser) {
        window.location.href = "user-auth.html";
      }

      document.getElementById(
        "user-name"
      ).textContent = `Hello, ${currentUser.name}`;
      document.getElementById("profile-name").textContent = currentUser.name;
      document.getElementById("profile-email").textContent = currentUser.email;
      document.getElementById("profile-since").textContent = new Date(
        currentUser.id || Date.now()
      ).toLocaleDateString();

      function renderRecentOrders() {
        const container = document.getElementById("recent-orders");
        const recentOrders = (currentUser.orders || []).slice(-3).reverse();

        if (recentOrders.length === 0) {
          container.innerHTML = "<p class='text-zinc-500'>No orders yet</p>";
          return;
        }

        container.innerHTML = recentOrders
          .map(
            (order) => `
          <div class="border border-white/10 rounded-lg p-3">
            <p class="font-medium">Order #${order.id}</p>
            <p class="text-sm text-zinc-400">${new Date(
              order.date
            ).toLocaleDateString()}</p>
            <p class="text-green-500 font-semibold">Rp ${order.total.toLocaleString()}</p>
          </div>
        `
          )
          .join("");
      }

      document.getElementById("logout-btn").onclick = () => {
        petalApp.setCurrentUser(null);
        window.location.href = "user-auth.html";
      };

      renderRecentOrders();
      lucide.createIcons();
    </script>
  </body>
</html>
